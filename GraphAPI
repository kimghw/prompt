# ğŸ“˜ Microsoft Graph API ì´ë©”ì¼ ì¡°íšŒ ì™„ë²½ ê°€ì´ë“œ

ì´ ë¬¸ì„œëŠ” Microsoft Graph APIë¥¼ í™œìš©í•˜ì—¬ íŠ¹ì • ì‚¬ìš©ì ë˜ëŠ” ëª¨ë“  ì‚¬ìš©ìì˜ ë©”ì¼ì„ íš¨ê³¼ì ìœ¼ë¡œ ì¡°íšŒí•˜ëŠ” ë°©ë²•ì„ ì²´ê³„ì ìœ¼ë¡œ ì•ˆë‚´í•©ë‹ˆë‹¤. OData ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜ë¥¼ í™œìš©í•œ ê¸°ë³¸ ë° ê³ ê¸‰ í•„í„°ë§ ì˜ˆì œë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.

### 1. ê¸°ë³¸ API ì—”ë“œí¬ì¸íŠ¸

- **ë‚´ ë©”ì¼ ì¡°íšŒ (ìœ„ì„ëœ ê¶Œí•œ):**
  ```http
  GET [https://graph.microsoft.com/v1.0/me/messages](https://graph.microsoft.com/v1.0/me/messages)
  ```
- **íŠ¹ì • ì‚¬ìš©ì ë©”ì¼ ì¡°íšŒ (ìœ„ì„ëœ/ì• í”Œë¦¬ì¼€ì´ì…˜ ê¶Œí•œ):**
  ```http
  GET [https://graph.microsoft.com/v1.0/users/](https://graph.microsoft.com/v1.0/users/){ì‚¬ìš©ì ID ë˜ëŠ” UPN}/messages
  ```

---

### 2. í•µì‹¬ OData ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜

| ë§¤ê°œë³€ìˆ˜      | ì„¤ëª…                                                               | ì‚¬ìš© ì˜ˆì‹œ                                   |
| :---------- | :----------------------------------------------------------------- | :------------------------------------------ |
| **`$select`** | ì‘ë‹µì— í¬í•¨í•  íŠ¹ì • í•„ë“œë§Œ ì„ íƒí•˜ì—¬ ë°ì´í„° í¬ê¸°ë¥¼ ìµœì í™”í•©ë‹ˆë‹¤.     | `$select=subject,from,receivedDateTime`     |
| **`$filter`** | íŠ¹ì • ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ë§Œ í•„í„°ë§í•©ë‹ˆë‹¤.                            | `$filter=isRead eq false` (ì½ì§€ ì•Šì€ ë©”ì¼ë§Œ) |
| **`$orderby`** | ê²°ê³¼ë¥¼ íŠ¹ì • í•„ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•©ë‹ˆë‹¤. (`asc`/`desc`)             | `$orderby=receivedDateTime desc` (ìµœì‹ ìˆœ)    |
| **`$top`** | ê²°ê³¼ì˜ ê°œìˆ˜ë¥¼ ìƒìœ„ Nê°œë¡œ ì œí•œí•©ë‹ˆë‹¤.                               | `$top=10` (ìµœëŒ€ 10ê°œ)                      |
| **`$search`** | í‚¤ì›Œë“œë¡œ ë©”ì‹œì§€ë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤. (ì¸ë±ì‹±ëœ ëª¨ë“  í•„ë“œì—ì„œ ê²€ìƒ‰)        | `$search="íšŒì˜ë¡"`                          |

---

### 3. ì£¼ìš” ì¡°íšŒ ì‹œë‚˜ë¦¬ì˜¤ë³„ API ìš”ì²­ ì˜ˆì‹œ

*ì•„ë˜ ëª¨ë“  ì˜ˆì‹œëŠ” `https://graph.microsoft.com/v1.0` ë’¤ì— ë¶™ì—¬ì„œ ì‚¬ìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤.*

#### ğŸ“ˆ **A. ê¸°ê°„ ë° ê°œìˆ˜ í•„í„°ë§**

**1. ìµœê·¼ ë©”ì¼ 10ê°œ ì¡°íšŒ**
> `orderby`ë¡œ ìµœì‹ ìˆœ ì •ë ¬ í›„ `top`ìœ¼ë¡œ ê°œìˆ˜ë¥¼ ì œí•œí•©ë‹ˆë‹¤.
```http
GET /me/messages?$orderby=receivedDateTime desc&$top=10
```

**2. íŠ¹ì • ê¸°ê°„ì˜ ë©”ì¼ ì¡°íšŒ (ì˜ˆ: 2025ë…„ 5ì›”)**
> `filter`ë¥¼ ì‚¬ìš©í•˜ì—¬ `receivedDateTime`ì´ íŠ¹ì • ë²”ìœ„ì— ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
```http
GET /me/messages?$filter=receivedDateTime ge 2025-05-01T00:00:00Z and receivedDateTime lt 2025-06-01T00:00:00Z
```

#### ğŸ“‚ **B. ìƒíƒœ ë° ì†ì„± í•„í„°ë§**

**1. ì½ì§€ ì•Šì€ ë©”ì¼ë§Œ ì¡°íšŒ**
> `isRead` ì†ì„±ì„ `false`ë¡œ í•„í„°ë§í•©ë‹ˆë‹¤.
```http
GET /me/messages?$filter=isRead eq false
```

**2. íŠ¹ì •ì¸ì—ê²Œì„œ ì˜¨ ë©”ì¼ ì¡°íšŒ**
> `from` ì£¼ì†Œì˜ `emailAddress` ê°ì²´ë¥¼ í•„í„°ë§í•©ë‹ˆë‹¤.
```http
GET /me/messages?$filter=from/emailAddress/address eq 'noreply@google.com'
```

**3. 'ì¤‘ìš”' í‘œì‹œê°€ ìˆëŠ” ë©”ì¼ë§Œ ì¡°íšŒ**
> `importance` ì†ì„±ì„ í•„í„°ë§í•©ë‹ˆë‹¤. (`low`, `normal`, `high`)
```http
GET /me/messages?$filter=importance eq 'high'
```

#### ğŸ” **C. ë‚´ìš© ê²€ìƒ‰ ë° í•„ë“œ ì„ íƒ**

**1. ì œëª©, ë³¸ë¬¸ ë“±ì—ì„œ í‚¤ì›Œë“œ ê²€ìƒ‰**
> `search`ë¥¼ ì‚¬ìš©í•˜ì—¬ ììœ ë¡œìš´ í…ìŠ¤íŠ¸ ê²€ìƒ‰ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. (ê°€ì¥ í¸ë¦¬í•¨)
```http
GET /me/messages?$search="í”„ë¡œì íŠ¸ ì œì•ˆì„œ"
```

**2. íŠ¹ì • í•„ë“œë§Œ ì„ íƒí•˜ì—¬ ì¡°íšŒ (ì„±ëŠ¥ ìµœì í™”)**
> `select`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì œëª©, ë³´ë‚¸ ì‚¬ëŒ, ë°›ì€ ë‚ ì§œë§Œ ê°€ì ¸ì˜µë‹ˆë‹¤.
```http
GET /me/messages?$select=subject,from,receivedDateTime
```

**3. ë³¸ë¬¸ì„ ì¼ë°˜ í…ìŠ¤íŠ¸(TEXT) í˜•ì‹ìœ¼ë¡œ ë°›ê¸°**
> `Prefer` í—¤ë”ë¥¼ ì¶”ê°€í•˜ì—¬ HTMLì´ ì•„ë‹Œ TEXT í˜•ì‹ì˜ ë³¸ë¬¸ì„ ìš”ì²­í•©ë‹ˆë‹¤.
```http
GET /me/messages?$select=subject,body
Prefer: outlook.body-content-type="text"
```

---

### 4. ê³ ê¸‰ ì¡°í•© ì˜ˆì‹œ

> **"2025ë…„ 5ì›” í•œ ë‹¬ê°„ 'ê¹€ë¯¼ì¤€'ì—ê²Œì„œ ì˜¨ ì½ì§€ ì•Šì€ ë©”ì¼ì„ ìµœì‹ ìˆœìœ¼ë¡œ 5ê°œ ì¡°íšŒí•˜ë˜, ì œëª©ê³¼ ë°›ì€ ë‚ ì§œë§Œ ê°€ì ¸ì˜¤ê¸°"**

```http
GET /me/messages?$filter=receivedDateTime ge 2025-05-01T00:00:00Z and receivedDateTime lt 2025-06-01T00:00:00Z and from/emailAddress/address eq 'minjun.kim@example.com' and isRead eq false&$orderby=receivedDateTime desc&$top=5&$select=subject,receivedDateTime
```

---
*ì´ ê°€ì´ë“œê°€ Graph APIë¥¼ í™œìš©í•œ ë©”ì¼ ê¸°ëŠ¥ ê°œë°œì— ë„ì›€ì´ ë˜ê¸°ë¥¼ ë°”ëë‹ˆë‹¤.*
